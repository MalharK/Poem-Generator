import requests, csv
from bs4 import BeautifulSoup

# Collect first page of artistsâ€™ list
page = requests.get('https://100.best-poems.net/top-100-best-poems.html')
# Create a BeautifulSoup object
soup = BeautifulSoup(page.text, 'html.parser')
poem_name_list = soup.find(id='content')
base_url = 'https://100.best-poems.net'
# Pull text from all instances of <a> tag within BodyText div
poem_name_list_items = poem_name_list.find_all('a', href=True)
file = open('poem_file_names.csv', 'w')
poem_file = open('poems.txt', 'w')
f = csv.writer(file)
for poem_name in poem_name_list_items:
    f.writerow([poem_name.contents[0]
               .replace(" ", "")
               .replace("'", "")
               .replace("?", "")
               .replace(":", "")
               .replace(";", "")
               .replace(",", ""),
                (base_url + poem_name['href'])])
    name = poem_name.contents[0].replace(" ", "").replace("'", "").replace("?", "").replace(":", "").replace(";", "").replace(",", "")
    if name != "DeathsAndEntrances" and name!= "Epithalamion" and name != "GoblinMarket" and name != "ICannotLiveWithYou"\
            and name != "InArthursHouse" and name != "Sick" and name != "TheBlessedDamozel"\
            and name != "The Charge of the Light Brigade":
        page = requests.get(base_url + poem_name['href'])
        soup = BeautifulSoup(page.text, 'html.parser')
        poem = soup.find(class_='content-poetry')
        poem_paras = poem.find_all('p')
        try:
            for x in poem_paras:
                    for e in x.findAll('br'):
                        e.extract()
                    for line in x:
                        poem_file.write(line.replace("\n", ""))
                        poem_file.write('\n')
            poem_file.write('\n')
        except:
            print("Error in parsing")


# html = '<div class="entry-content clearfix"><div id="content"> <div class="node"><h2 class="author">by Dylan Thomas</h2><div class="share-box pull-right"><ul class="clearfix"><li class="clearfix"><a class="addthis_button_email" target="_blank" title="Email" href="#"><span class="icon-envelope"></span>Email</a><a class="addthis_button_print pull-right" title="Print" href="#"><span class="icon-print"></span>Print</a></li></ul></div><div class="content-poetry"><!--paging_filter--><p>Do not go gentle into that good night,<br>Old age should burn and rave at close of day;<br>Rage, rage against the dying of the light.</p><p>Though wise men at their end know dark is right,<br>Because their words had forked no lightning they<br>Do not go gentle into that good night.</p><p>Good men, the last wave by, crying how bright<br>Their frail deeds might have danced in a green bay,<br>Rage, rage against the dying of the light.</p><p>Wild men who caught and sang the sun in flight,<br>And learn, too late, they grieved it on its way,<br>Do not go gentle into that good night.</p><p>Grave men, near death, who see with blinding sight<br>Blind eyes could blaze like meteors and be gay,<br>Rage, rage against the dying of the light.</p><p>And you, my father, there on the sad height,<br>Curse, bless, me now with your fierce tears, I pray.<br>Do not go gentle into that good night.<br>Rage, rage against the dying of the light.</p></div><p></p><div class="addthis_toolbox addthis_default_style"><a class="addthis_button_stumbleupon at300b" target="_blank" title="StumbleUpon" href="#"><span class="at-icon-wrapper" style="background-color: rgb(235, 73, 36); line-height: 16px; height: 16px; width: 16px;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" version="1.1" role="img" aria-labelledby="at-svg-stumbleupon-1" title="StumbleUpon" alt="StumbleUpon" class="at-icon at-icon-stumbleupon" style="width: 16px; height: 16px;"><title id="at-svg-stumbleupon-1">StumbleUpon</title><g><path d="M17.17 14.29l1.5.7 2.234-.665v-1.558C20.904 10.12 18.67 8 16 8c-2.658 0-4.904 2.108-4.904 4.732v7.104c0 .654-.527 1.17-1.17 1.17-.64 0-1.168-.516-1.168-1.17v-3.002H5v3.048c0 2.716 2.2 4.916 4.916 4.916 2.692 0 4.915-2.166 4.915-4.847v-7.01c0-.643.528-1.17 1.17-1.17.642 0 1.17.527 1.17 1.17v1.35zm6.072 2.544v3.15c0 .643-.527 1.16-1.17 1.16-.64 0-1.168-.517-1.168-1.16v-3.092l-2.234.664-1.5-.7v3.072c0 2.693 2.21 4.87 4.914 4.87 2.716 0 4.916-2.2 4.916-4.916v-3.048h-3.758z" fill-rule="evenodd"></path></g></svg></span></a><a class="addthis_button_reddit at300b" target="_blank" title="Reddit" href="#"><span class="at-icon-wrapper" style="background-color: rgb(255, 87, 0); line-height: 16px; height: 16px; width: 16px;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" version="1.1" role="img" aria-labelledby="at-svg-reddit-2" title="Reddit" alt="Reddit" class="at-icon at-icon-reddit" style="width: 16px; height: 16px;"><title id="at-svg-reddit-2">Reddit</title><g><path d="M27 15.5a2.452 2.452 0 0 1-1.338 2.21c.098.38.147.777.147 1.19 0 1.283-.437 2.47-1.308 3.563-.872 1.092-2.06 1.955-3.567 2.588-1.506.634-3.143.95-4.91.95-1.768 0-3.403-.316-4.905-.95-1.502-.632-2.69-1.495-3.56-2.587-.872-1.092-1.308-2.28-1.308-3.562 0-.388.045-.777.135-1.166a2.47 2.47 0 0 1-1.006-.912c-.253-.4-.38-.842-.38-1.322 0-.678.237-1.26.712-1.744a2.334 2.334 0 0 1 1.73-.726c.697 0 1.29.26 1.78.782 1.785-1.258 3.893-1.928 6.324-2.01l1.424-6.467a.42.42 0 0 1 .184-.26.4.4 0 0 1 .32-.063l4.53 1.006c.147-.306.368-.553.662-.74a1.78 1.78 0 0 1 .97-.278c.508 0 .94.18 1.302.54.36.36.54.796.54 1.31 0 .512-.18.95-.54 1.315-.36.364-.794.546-1.302.546-.507 0-.94-.18-1.295-.54a1.793 1.793 0 0 1-.533-1.308l-4.1-.92-1.277 5.86c2.455.074 4.58.736 6.37 1.985a2.315 2.315 0 0 1 1.757-.757c.68 0 1.256.242 1.73.726.476.484.713 1.066.713 1.744zm-16.868 2.47c0 .513.178.95.534 1.315.356.365.787.547 1.295.547.508 0 .942-.182 1.302-.547.36-.364.54-.802.54-1.315 0-.513-.18-.95-.54-1.31-.36-.36-.794-.54-1.3-.54-.5 0-.93.183-1.29.547a1.79 1.79 0 0 0-.54 1.303zm9.944 4.406c.09-.09.135-.2.135-.323a.444.444 0 0 0-.44-.447c-.124 0-.23.042-.32.124-.336.348-.83.605-1.486.77a7.99 7.99 0 0 1-1.964.248 7.99 7.99 0 0 1-1.964-.248c-.655-.165-1.15-.422-1.486-.77a.456.456 0 0 0-.32-.124.414.414 0 0 0-.306.124.41.41 0 0 0-.135.317.45.45 0 0 0 .134.33c.352.355.837.636 1.455.843.617.207 1.118.33 1.503.366a11.6 11.6 0 0 0 1.117.056c.36 0 .733-.02 1.117-.056.385-.037.886-.16 1.504-.366.62-.207 1.104-.488 1.456-.844zm-.037-2.544c.507 0 .938-.182 1.294-.547.356-.364.534-.802.534-1.315 0-.505-.18-.94-.54-1.303a1.75 1.75 0 0 0-1.29-.546c-.506 0-.94.18-1.3.54-.36.36-.54.797-.54 1.31s.18.95.54 1.315c.36.365.794.547 1.3.547z" fill-rule="evenodd"></path></g></svg></span></a><a class="addthis_button_delicious"></a><a class="addthis_button_digg at300b" target="_blank" title="Digg" href="#"><span class="at-icon-wrapper" style="background-color: rgb(34, 30, 30); line-height: 16px; height: 16px; width: 16px;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" version="1.1" role="img" aria-labelledby="at-svg-digg-3" title="Digg" alt="Digg" class="at-icon at-icon-digg" style="width: 16px; height: 16px;"><title id="at-svg-digg-3">Digg</title><g><path d="M8.523 10h2.19v10.558H5v-7.486h3.523V10zm0 8.796v-3.963h-1.32v3.963h1.32zm5.273-5.724v7.486h-2.2v-7.486h2.2zm0-3.072v2.19h-2.2V10h2.2zm.88 3.072h5.726V23.19h-5.725v-1.75H18.2v-.882h-3.523v-7.486zm3.524 5.724v-3.963h-1.32v3.963h1.32zm3.082-5.724h5.714V23.19h-5.714v-1.75h3.513v-.882h-3.513v-7.486zm3.513 5.724v-3.963h-1.322v3.963h1.322z" fill-rule="evenodd"></path></g></svg></span></a><a class="addthis_button_google at300b" target="_blank" title="Google Bookmark" href="#"><span class="at-icon-wrapper" style="background-color: rgb(66, 133, 244); line-height: 16px; height: 16px; width: 16px;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" version="1.1" role="img" aria-labelledby="at-svg-google-4" title="Google Bookmark" alt="Google Bookmark" class="at-icon at-icon-google" style="width: 16px; height: 16px;"><title id="at-svg-google-4">Google Bookmark</title><g><path d="M16.213 13.998H26.72c.157.693.28 1.342.28 2.255C27 22.533 22.7 27 16.224 27 10.03 27 5 22.072 5 16S10.03 5 16.224 5c3.03 0 5.568 1.09 7.51 2.87l-3.188 3.037c-.808-.748-2.223-1.628-4.322-1.628-3.715 0-6.745 3.024-6.745 6.73 0 3.708 3.03 6.733 6.744 6.733 4.3 0 5.882-2.915 6.174-4.642h-6.185V14z" fill-rule="evenodd"></path></g></svg></span></a><span class="addthis_separator">|</span><a class="addthis_button_compact at300m" href="#"><span class="at-icon-wrapper" style="background-color: rgb(255, 101, 80); line-height: 16px; height: 16px; width: 16px;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" version="1.1" role="img" aria-labelledby="at-svg-addthis-5" title="More" alt="More" class="at-icon at-icon-addthis" style="width: 16px; height: 16px;"><title id="at-svg-addthis-5">Addthis</title><g><path d="M18 14V8h-4v6H8v4h6v6h4v-6h6v-4h-6z" fill-rule="evenodd"></path></g></svg></span>&nbsp;Share this Poem</a><a class="addthis_counter addthis_bubble_style" href="#" style="display: inline-block;"><a class="addthis_button_expanded" target="_blank" title="More" href="#">706</a><a class="atc_s addthis_button_compact">Share<span></span></a></a><div class="atclear"></div></div><script type="text/javascript" src="https://s7.addthis.com/js/250/addthis_widget.js#username=xa-4d49ffe8656f6e13"></script><p></p><div class="clear"></div><footer class="clearfix"><span><p class="prev-post pull-left clearfix"><a href="/what-do-you-see-nurse.html" title="What Do You See, Nurse?" class="link">&lt; previous poem</a></p><p class="next-post pull-right clearfix"></p><ul class="links inline"><li class="first taxonomy_term_22"><a href="/10-best-poems-about-death.html" rel="tag" title="This is a list of the most popular and best poems about death of all time. Written by famous or ordinary people, these funeral poems are the most famous in english literature." class="taxonomy_term_22">Best Poems About Death and Funerals</a></li><li class="last taxonomy_term_1"><a href="/top-100-best-poems.html" rel="tag" title="Top 100 best and all time famous and most popular poems in english literature" class="taxonomy_term_1">Top 100 poems</a></li></ul></span></footer></div><br><footer class="clearfix"><script async="" src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><!-- BP2 --><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-1316279038755285" data-ad-slot="8252071914" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script> </footer> </div></div>'

file.close()
poem_file.close()
